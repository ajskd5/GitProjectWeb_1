<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sist.mapper.board_reply-mapper">
	<!-- 총페이지 -->
	<select id="boardReplyTotalPage" resultType="int">
		SELECT CEIL(COUNT(*)/10.0) FROM project_replyBoard
	</select>
	<!-- 목록 가지고 오기 -->
	<!--					group_id	group_step	group_tab	isreply
								(답변/게시물 뭔지 확인) 
		AAAAAA					2			0			0			1
			=> BBBBBB			2			1			1			0
		CCCCCC					1			0			0			1
			=> DDDDDD			1			1			1			0
	 -->
	<select id="boardReplyListData" resultType="BoardReplyVO" parameterType="hashmap">
		SELECT no, subject, content, name, TO_CHAR(regdate, 'YYYY-MM-DD') as dbday, hit, isreply, group_id, group_tab, num
		FROM (SELECT no, subject, content, name, regdate, hit, isreply, group_id, group_tab, rownum as num 
		FROM (SELECT no, subject, content, name, regdate, hit, isreply, group_id, group_tab 
		FROM project_replyBoard ORDER BY group_id DESC, group_step ASC))
		WHERE num BETWEEN #{start} AND #{end}
	</select>
	
	
	<!-- 상세보기 -->
	<!-- 수정, 삭제 -->
	<!-- 추가(사용자) -->
	<insert id="boardReplyInsert" parameterType="BoardReplyVO">
		<selectKey keyProperty="no" resultType="int" order="BEFORE"><!-- 자동증가번호 -->
			SELECT NVL(MAX(no)+1, +1) as no FROM project_replyBoard
		</selectKey>
		INSERT INTO project_replyBoard(no, name, subject, content, pwd, group_id)
		VALUES(#{no}, #{name}, #{subject}, #{content}, #{pwd}, 
		(SELECT NVL(MAX(group_id)+1, +1) FROM project_replyBoard)) 
	</insert>
	
	<!-- 답변 달기(관리자) -->
</mapper>